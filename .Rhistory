hjust = 'center',
vjust = 'top'
) +
theme_void()
ggplot(to_plot, aes(x = rpg_off, y = rpg_def)) +
geom_mlb_logos(
aes(
team_abbr = team_abbr,
),
width = 0.06,
alpha = 0.8
) +
# geom_point() +
geom_hline(
yintercept = median_rpg_def,
linewidth = 0.15,
alpha = 0.3
) +
geom_vline(
xintercept = median_rpg_off,
linewidth = 0.15,
alpha = 0.3
) +
scale_y_reverse(
# limits = y_axis_limits
limits = c(6.1, 3.8)
) +
scale_x_continuous(
# limits = x_axis_limits
limits = c(3.5, 6.1)
) +
geom_text(
data = text_df_y,
mapping = aes(x = x, y = y, label = label),
size = 24,
hjust = 'center',
vjust = 'center',
color = '#999999',
alpha = 0.3
) +
geom_text(
data = text_df_x,
mapping = aes(x = x, y = y, label = label),
size = 24,
hjust = 'center',
vjust = 'center',
color = '#999999',
alpha = 0.3
) +
annotate(
'text',
x = median_rpg_off + .08,
y = 6.1,
label = 'runs allowed per game',
color = '#999999',
alpha = 0.7,
size = 4,
hjust = 'left',
vjust = 'bottom'
) +
annotate(
'text',
x = 6,
y = median_rpg_def + .16,
label = 'runs scored\nper game',
color = '#999999',
alpha = 0.7,
size = 4,
hjust = 'center',
vjust = 'top'
) +
theme_void()
ggplot(to_plot, aes(x = rpg_off, y = rpg_def)) +
geom_mlb_logos(
aes(
team_abbr = team_abbr,
),
width = 0.06,
alpha = 1
) +
# geom_point() +
geom_hline(
yintercept = median_rpg_def,
linewidth = 0.15,
alpha = 0.3
) +
geom_vline(
xintercept = median_rpg_off,
linewidth = 0.15,
alpha = 0.3
) +
scale_y_reverse(
# limits = y_axis_limits
limits = c(6.2, 3.8)
) +
scale_x_continuous(
# limits = x_axis_limits
limits = c(3.5, 6.1)
) +
geom_text(
data = text_df_y,
mapping = aes(x = x, y = y, label = label),
size = 24,
hjust = 'center',
vjust = 'center',
color = '#999999',
alpha = 0.3
) +
geom_text(
data = text_df_x,
mapping = aes(x = x, y = y, label = label),
size = 24,
hjust = 'center',
vjust = 'center',
color = '#999999',
alpha = 0.3
) +
annotate(
'text',
x = median_rpg_off + .08,
y = 6.15,
label = 'runs allowed per game',
color = '#999999',
alpha = 0.7,
size = 4,
hjust = 'left',
vjust = 'bottom'
) +
annotate(
'text',
x = 6,
y = median_rpg_def + .18,
label = 'runs scored\nper game',
color = '#999999',
alpha = 0.7,
size = 4,
hjust = 'center',
vjust = 'top'
) +
theme_void()
library(ggpmisc)
library(mlbplotR)
library(ggplot2)
library(baseballr)
library(tidyverse)
library(lubridate)
library(mlbplotR)
# setwd('baseball')
season <- 2023
team_pitching_stats <- baseballr::mlb_teams_stats(
stat_type = 'season',
stat_group = 'pitching',
sport_ids = 1,
season = season
)
team_pitching_stats %>%
arrange(runs_scored_per9) %>%
select(team_name, runs_scored_per9) %>%
print(n = 30)
teams_colors_logos <- mlbplotR::load_mlb_teams()
to_plot <- team_pitching_stats %>%
left_join(
teams_colors_logos %>% select(team_name, team_abbr),
by = 'team_name'
) %>%
mutate(
across(c(strikeouts_per9inn, runs_scored_per9), as.numeric)
)
ggplot(
to_plot,
aes(
x = strikeouts_per9inn,
y = runs_scored_per9
)
) +
geom_mlb_logos(
aes(
team_abbr = team_abbr,
),
width = 0.06,
alpha = 1
) +
# # geom_point() +
# geom_hline(
#   yintercept = median_rpg_def,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
# geom_vline(
#   xintercept = median_rpg_off,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
scale_y_continuous(
name = 'runs allowed per 9 innings',
limits = c(3.8, 6.2),
breaks = seq(4, 6, .5)
) +
scale_x_continuous(
name = 'strikeouts per 9 innings',
limits = c(7, 10),
breaks = seq(7, 10, 0.5)
) +
# geom_text(
#   data = text_df_y,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# geom_text(
#   data = text_df_x,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# annotate(
#   'text',
#   x = median_rpg_off + .08,
#   y = 6.15,
#   label = 'runs allowed per game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'left',
#   vjust = 'bottom'
# ) +
# annotate(
#   'text',
#   x = 6,
#   y = median_rpg_def + .18,
#   label = 'runs scored\nper game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'center',
#   vjust = 'top'
# ) +
stat_poly_line() +
stat_poly_eq(use_label(c("eq", "R2"))) +
theme_bw()
ggplot(
to_plot,
aes(
x = strikeouts_per9inn,
y = runs_scored_per9
)
) +
geom_mlb_logos(
aes(
team_abbr = team_abbr,
),
width = 0.06,
alpha = 1
) +
# # geom_point() +
# geom_hline(
#   yintercept = median_rpg_def,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
# geom_vline(
#   xintercept = median_rpg_off,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
scale_y_continuous(
name = 'runs allowed per 9 innings',
limits = c(3.8, 6.2),
breaks = seq(4, 6, .5)
) +
scale_x_continuous(
name = 'strikeouts per 9 innings',
limits = c(7, 10),
breaks = seq(7, 10, 0.5)
) +
# geom_text(
#   data = text_df_y,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# geom_text(
#   data = text_df_x,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# annotate(
#   'text',
#   x = median_rpg_off + .08,
#   y = 6.15,
#   label = 'runs allowed per game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'left',
#   vjust = 'bottom'
# ) +
# annotate(
#   'text',
#   x = 6,
#   y = median_rpg_def + .18,
#   label = 'runs scored\nper game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'center',
#   vjust = 'top'
# ) +
theme_bw()
ggplot(
to_plot,
aes(
x = strikeouts_per9inn,
y = runs_scored_per9
)
) +
geom_mlb_logos(
aes(
team_abbr = team_abbr,
),
width = 0.06,
alpha = 1
) +
# # geom_point() +
# geom_hline(
#   yintercept = median_rpg_def,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
# geom_vline(
#   xintercept = median_rpg_off,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
scale_y_continuous(
name = 'runs allowed per 9 innings',
limits = c(3.8, 6.2),
breaks = seq(4, 6, .5)
) +
scale_x_continuous(
name = 'strikeouts per 9 innings',
limits = c(7, 10),
breaks = seq(7, 10, 0.5)
) +
# geom_text(
#   data = text_df_y,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# geom_text(
#   data = text_df_x,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# annotate(
#   'text',
#   x = median_rpg_off + .08,
#   y = 6.15,
#   label = 'runs allowed per game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'left',
#   vjust = 'bottom'
# ) +
# annotate(
#   'text',
#   x = 6,
#   y = median_rpg_def + .18,
#   label = 'runs scored\nper game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'center',
#   vjust = 'top'
# ) +
geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
theme_bw()
lm_eqn <- function(df){
m <- lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
p1 <- p + geom_text(x = 25, y = 300, label = lm_eqn(df), parse = TRUE)
lm_eqn <- function(df){
m <- lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
lm_eqn <- function(df, col1, col2){
df2 <- df %>% rename(c('x' = col1, 'y' = col2))
m <- lm(y ~ x, df2);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
ggplot(
to_plot,
aes(
x = strikeouts_per9inn,
y = runs_scored_per9
)
) +
geom_mlb_logos(
aes(
team_abbr = team_abbr,
),
width = 0.06,
alpha = 1
) +
# # geom_point() +
# geom_hline(
#   yintercept = median_rpg_def,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
# geom_vline(
#   xintercept = median_rpg_off,
#   linewidth = 0.15,
#   alpha = 0.3
# ) +
scale_y_continuous(
name = 'runs allowed per 9 innings',
limits = c(3.8, 6.2),
breaks = seq(4, 6, .5)
) +
scale_x_continuous(
name = 'strikeouts per 9 innings',
limits = c(7, 10),
breaks = seq(7, 10, 0.5)
) +
# geom_text(
#   data = text_df_y,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# geom_text(
#   data = text_df_x,
#   mapping = aes(x = x, y = y, label = label),
#   size = 24,
#   hjust = 'center',
#   vjust = 'center',
#   color = '#999999',
#   alpha = 0.3
# ) +
# annotate(
#   'text',
#   x = median_rpg_off + .08,
#   y = 6.15,
#   label = 'runs allowed per game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'left',
#   vjust = 'bottom'
# ) +
# annotate(
#   'text',
#   x = 6,
#   y = median_rpg_def + .18,
#   label = 'runs scored\nper game',
#   color = '#999999',
#   alpha = 0.7,
#   size = 4,
#   hjust = 'center',
#   vjust = 'top'
# ) +
geom_smooth(
method = "lm",
se = TRUE,
color = "#aaaadd",
linewidth = 0.5,
formula = y ~ x
) +
geom_text(x = 9.25, y = 6, label = lm_eqn(to_plot, col1 = 'strikeouts_per_9inn', col2 = 'runs_scored_per9'), parse = TRUE) +
theme_bw()
setwd('baseball/make')
setwd('baseball/make_dash/')
library(shiny); runApp('todays_games.R')
